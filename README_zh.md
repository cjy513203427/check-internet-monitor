[English](./README.md) | 中文

# 网络监控检测工具 (Network Monitoring Detection Tool)

一个用于检测系统是否存在网络监控的Python工具。该工具可以帮助识别代理设置、抓包工具、可疑网络连接以及潜在的中间人攻击。

## 功能特性

- **代理检测**: 检查系统和环境变量中的代理配置。
- **进程监控**: 识别常见的网络抓包和监控工具（如 Wireshark, Fiddler, Charles）。
- **网络接口分析**: 检测虚拟网络适配器和VPN连接。
- **连接分析**: 检查可疑的监听端口和活动连接。
- **证书检测**: 测试TLS/SSL连接以发现潜在的中间人攻击。
- **持续监控**: 实时监控模式，可定期扫描并报告新的和已解决的威胁。
- **双语支持**: 支持中文和英文输出。
- **彩色终端输出**: 清晰的风险等级展示。
- **JSON导出**: 支持将单次扫描的检测结果导出为JSON格式。

## 系统要求

- Python 3.6+
- Windows / Linux / macOS

## 安装

### 1. 克隆或下载项目

```bash
cd check-internet-monitor
```

### 2. 安装依赖

使用 conda 环境（推荐）:

```bash
conda activate your_env_name
pip install -r requirements.txt
```

或使用 pip:

```bash
pip install -r requirements.txt
```

## 使用方法

### 基本用法

运行一次完整的单次扫描：

```bash
python main.py
```

使用英文输出：

```bash
python main.py --lang en
```

### 持续监控模式

启用实时监控以检测变化。工具将按固定的时间间隔进行扫描，并且只报告新增或已解决的发现。

```bash
# 启动监控模式（默认30秒间隔）
python main.py --monitor

# 自定义检测间隔（例如10秒）
python main.py --monitor --interval 10

# 使用英文输出的监控模式
python main.py --monitor --lang en

# 按 Ctrl+C 停止监控
```

### 快速模式

在单次扫描中，跳过耗时的证书检测：

```bash
python main.py --quick
```

### 导出结果

将单次扫描的结果导出到JSON文件：

```bash
python main.py --json report.json
```

### 命令行选项

```
usage: main.py [-h] [--json FILE] [--quick] [--lang {zh,en}] [--monitor] [--interval SECONDS]

检测系统上的网络监控和监视

可选参数:
  -h, --help            显示帮助信息并退出
  --json FILE           将结果导出到JSON文件
  --quick               跳过缓慢的检查(证书验证)
  --lang {zh,en}        输出语言 (zh=中文, en=英文)
  --monitor             启用持续监控模式
  --interval SECONDS    监控检测间隔(秒，默认30秒)
```

## 检测模块说明

工具包含以下检测模块：

1.  **代理检测**: 检查环境变量和系统设置中的代理。
2.  **进程检测**: 扫描已知监控工具的运行进程。
3.  **网络接口检测**: 查找虚拟适配器和VPN迹象。
4.  **连接分析**: 分析监听端口和已建立的连接，寻找可疑模式。
5.  **证书检测**: 检查常用网站的TLS证书，发现中间人攻击（MITM）迹象。

## 输出示例

### 单次扫描模式

单次扫描会提供所有发现的完整报告。
```
======================================================================
网络监控检测报告
生成时间: 2024-01-15 10:30:45
======================================================================

总体风险级别: 高

[代理检测]
  风险级别: 中
  发现: 1
    1. [中] 环境变量代理: HTTP_PROXY=http://proxy.company.com:8080

...
```

### 持续监控模式

监控模式首先会进行一次初始扫描，之后只报告发生变化的项目。

```
======================================================================
持续监控模式
启动时间: 2024-01-15 11:00:00
检测间隔: 30 秒
停止监控: Ctrl+C
======================================================================

正在执行初始扫描...

[11:00:30] ✓ 周期 #1 完成 - 未发现变化
[11:01:00] ✓ 周期 #2 完成 - 未发现变化

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
🔔 检测到系统状态变化!
生成时间: 2024-01-15 11:01:30
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

 ⚠️ 发现新的监控活动:
  [进程检测] 风险级别: 高
    • 可疑进程: Fiddler (HTTP Debugger) (PID: 5678, 名称: Fiddler.exe)

[11:02:00] ✓ 周期 #4 完成 - 未发现变化

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
🔔 检测到系统状态变化!
生成时间: 2024-01-15 11:02:30
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

 ✓ 已解决的监控活动:
  [进程检测]
    • 可疑进程: Fiddler (HTTP Debugger) (PID: 5678, 名称: Fiddler.exe)

```

## 注意事项

1.  **权限要求**: 为获得最完整的结果，建议以管理员/root权限运行。
2.  **误报可能**: 某些发现可能是合法的（如企业VPN、杀毒软件等），请结合实际情况解读结果。
3.  **网络连接**: 证书检测模块需要有效的互联网连接。

## 免责声明

本工具仅用于合法的安全审计和教育目的，作者不对任何滥用行为负责。

## 项目结构

```
check-internet-monitor/
├── main.py                    # 主入口脚本
├── detectors/
│   ├── __init__.py
│   ├── proxy_detector.py      # 代理检测模块
│   ├── process_detector.py    # 进程检测模块
│   ├── network_detector.py    # 网络接口检测模块
│   ├── connection_detector.py # 连接分析模块
│   └── certificate_detector.py # 证书检测模块
├── utils/
│   ├── __init__.py
│   ├── change_detector.py     # 用于比较扫描结果的模块
│   ├── i18n.py                # 国际化模块
│   ├── monitor_reporter.py    # 监控模式的报告器
│   ├── monitoring_service.py  # 持续监控服务
│   └── reporter.py            # 基础报告生成工具
├── requirements.txt           # 依赖列表
├── README.md                  # 英文文档
└── README_zh.md               # 中文文档 (本文)
```

## 贡献

欢迎提交反馈、问题和代码贡献。

## 许可证

MIT License
